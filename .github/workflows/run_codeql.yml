name: Download and Unzip CodeQL
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Download CodeQL
      run: |
        curl -L -o codeql-linux64.zip https://github.com/github/codeql-cli-binaries/releases/download/v2.15.3/codeql-linux64.zip
      shell: bash

    - name: Unzip CodeQL
      run: |
        unzip codeql-linux64.zip -d codeql
      shell: bash

    - name: Set up CodeQL
      run: |
        export PATH=$PATH:$(pwd)/codeql
      shell: bash

    - name: Copy CodeQL Queries
      run: |
        # Iterate through each language folder in the "queries" directory
        for lang_folder in queries/*; do
          # Get the language name (e.g., python, java) from the folder name
          lang_name=$(basename "$lang_folder")

          # Copy queries from the "queries" folder to the corresponding folder in "codeql/codeql"
          cp -r "$lang_folder"/* "codeql/codeql/$lang_name/"
        done
      shell: bash
      
    - name: Check Directory
      run: |
        cd codeql/codeql/javascript
        ls -al
      shell: bash
